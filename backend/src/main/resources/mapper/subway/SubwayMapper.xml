<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.barotago.backend.subway.dao.SubwayDAO">
	<!-- 메인 노선 조회 (1호선, 2호선 등) -->
	<select id="selectMainLines" resultType="ServiceLine">
		select 
			line_code,
			line_name,
			color_hex,
			text_color,
			order_no
		from service_lines
		where line_code = parent_code
		order by order_no
	</select>
	<!-- 하위 노선 조회 (지선, 분기 노선 등) -->
	<select id="selectChildLines" resultType="ServiceLine">
		select
			line_code,
			line_name
		from service_lines
		where parent_code = #{parentCode}
		order by line_code
	</select>
	<!-- 노선별 역 목록 조회 -->
	<select id="findStationByLineCode" resultType="LineStationResponseDTO">
		select
			sls.sequence_no,
			s.station_name,
			s.station_cd
		from service_line_station sls
		join station s
			on sls.station_id = s.station_id
		where sls.line_code = #{lineCode}
		order by sls.sequence_no asc
	</select>
	<!-- 역 기본 정보 단건 조회 -->
	<select id="findStationDetailById">
		select
		    station_id,
		    station_name,
		    address,
		    latitude,
		    longitude,
		    phone
		from station
		where station_id = #{stationId};
	</select>
	<!-- 역 편의시설 목록 조회 -->
	<select id="findFacilitiesByStationId">
		select
		    f.facility_name,
		    f.icon_color
		from station_facility sf
		join facility f
		  	on sf.facility_id = f.facility_id
		where sf.station_id = #{stationId};
	</select>
</mapper>